<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Network Data Visualization</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        canvas {
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
        }
    </style>
</head>
<body>
    <h1>Live Network Data Visualization</h1>

    <div>
        <!-- Protocol Distribution Chart -->
        <canvas id="protocolChart"></canvas>
    </div>
    <div>
        <!-- Packet Size Distribution Chart -->
        <canvas id="packetSizeChart"></canvas>
    </div>
    <div>
        <!-- Inter-arrival Time Analysis Chart -->
        <canvas id="interArrivalTimeChart"></canvas>
    </div>
    <div>
        <!-- Flow Duration Analysis Chart -->
        <canvas id="flowDurationChart"></canvas>
    </div>
    <div>
        <!-- Top Conversations Chart -->
        <canvas id="topConversationsChart"></canvas>
    </div>
    <div>
        <!-- DNS Request Analysis Chart -->
        <canvas id="dnsRequestChart"></canvas>
    </div>
    <div>
        <!-- HTTP Request Analysis Chart -->
        <canvas id="httpRequestChart"></canvas>
    </div>
    <div>
        <!-- Geolocation Visualization Chart -->
        <canvas id="geolocationChart"></canvas>
    </div>
    <div>
        <!-- Anomaly Detection Chart -->
        <canvas id="anomalyDetectionChart"></canvas>
    </div>
    <div>
        <!-- Bandwidth Utilization Chart -->
        <canvas id="bandwidthUtilizationChart"></canvas>
    </div>
    <div>
        <!-- Network Topology Visualization Chart -->
        <canvas id="networkTopologyChart"></canvas>
    </div>
    <div>
        <!-- Correlation Analysis Chart -->
        <canvas id="correlationAnalysisChart"></canvas>
    </div>

    <script>
        // Initialize Chart.js instances for all charts
        var protocolContext = document.getElementById('protocolChart').getContext('2d');
        var packetSizeContext = document.getElementById('packetSizeChart').getContext('2d');
        var interArrivalTimeContext = document.getElementById('interArrivalTimeChart').getContext('2d');
        var flowDurationContext = document.getElementById('flowDurationChart').getContext('2d');
        var topConversationsContext = document.getElementById('topConversationsChart').getContext('2d');
        var dnsRequestContext = document.getElementById('dnsRequestChart').getContext('2d');
        var httpRequestContext = document.getElementById('httpRequestChart').getContext('2d');
        var geolocationContext = document.getElementById('geolocationChart').getContext('2d');
        var anomalyDetectionContext = document.getElementById('anomalyDetectionChart').getContext('2d');
        var bandwidthUtilizationContext = document.getElementById('bandwidthUtilizationChart').getContext('2d');
        var networkTopologyContext = document.getElementById('networkTopologyChart').getContext('2d');
        var correlationAnalysisContext = document.getElementById('correlationAnalysisChart').getContext('2d');

        // Function to initialize a line chart
        function initLineChart(context, data) {
            return new Chart(context, {
                type: 'line',
                data: data,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Function to initialize a bar chart
        function initBarChart(context, data) {
            return new Chart(context, {
                type: 'bar',
                data: data,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Function to fetch live data and update charts
        function fetchData() {
            fetch('/data-feed')
            .then(response => response.json())
            .then(data => {
                updateCharts(data);
            })
            .catch(error => console.error('Error fetching live data:', error));
        }

    // Function to update charts with new data
    function updateCharts(data) {
        updateProtocolChart(data.protocols);
        updatePacketSizeChart(data.packetSizes);
        updateInterArrivalTimeChart(data.interArrivalTime);
        updateFlowDurationChart(data.flowDuration);
        updateTopConversationsChart(data.topConversations);
        updateDNSRequestChart(data.dnsRequests);
        updateHTTPRequestChart(data.httpRequests);
        updateGeolocationChart(data.geolocation);
        updateAnomalyDetectionChart(data.anomalyDetection);
        updateBandwidthUtilizationChart(data.bandwidthUtilization);
        updateNetworkTopologyChart(data.networkTopology);
        updateCorrelationAnalysisChart(data.correlationAnalysis);
    }

        // Implement update functions for each chart

       // Update function for Packet Size Distribution Chart
function updatePacketSizeChart(data) {
    var packetSizeLabels = ['0-200', '201-400', '401-600', '601-800', '801-1000'];
    var packetSizeData = [0, 0, 0, 0, 0];

    data.packetSizes.forEach(packetSize => {
        if (packetSize >= 0 && packetSize <= 200) {
            packetSizeData[0]++;
        } else if (packetSize > 200 && packetSize <= 400) {
            packetSizeData[1]++;
        } else if (packetSize > 400 && packetSize <= 600) {
            packetSizeData[2]++;
        } else if (packetSize > 600 && packetSize <= 800) {
            packetSizeData[3]++;
        } else if (packetSize > 800 && packetSize <= 1000) {
            packetSizeData[4]++;
        }
    });

    packetSizeChart.data.datasets[0].data = packetSizeData;
    packetSizeChart.update();
}

// Update function for Inter-arrival Time Analysis Chart
function updateInterArrivalTimeChart(data) {
    interArrivalTimeChart.data.labels = data.labels;
    interArrivalTimeChart.data.datasets[0].data = data.values;
    interArrivalTimeChart.update();
}

// Update function for Flow Duration Analysis Chart
function updateFlowDurationChart(data) {
    flowDurationChart.data.labels = data.labels;
    flowDurationChart.data.datasets[0].data = data.values;
    flowDurationChart.update();
}

// Update function for Top Conversations Chart
function updateTopConversationsChart(data) {
    topConversationsChart.data.labels = data.labels;
    topConversationsChart.data.datasets[0].data = data.values;
    topConversationsChart.update();
}

// Update function for DNS Request Analysis Chart
function updateDNSRequestChart(data) {
    dnsRequestChart.data.labels = data.labels;
    dnsRequestChart.data.datasets[0].data = data.values;
    dnsRequestChart.update();
}

// Update function for HTTP Request Analysis Chart
function updateHTTPRequestChart(data) {
    httpRequestChart.data.labels = data.labels;
    httpRequestChart.data.datasets[0].data = data.values;
    httpRequestChart.update();
}

// Update function for Geolocation Visualization Chart
function updateGeolocationChart(data) {
    geolocationChart.data.labels = data.labels;
    geolocationChart.data.datasets[0].data = data.values;
    geolocationChart.update();
}

// Update function for Anomaly Detection Chart
function updateAnomalyDetectionChart(data) {
    anomalyDetectionChart.data.labels = data.labels;
    anomalyDetectionChart.data.datasets[0].data = data.values;
    anomalyDetectionChart.update();
}

// Update function for Bandwidth Utilization Chart
function updateBandwidthUtilizationChart(data) {
    bandwidthUtilizationChart.data.labels = data.labels;
    bandwidthUtilizationChart.data.datasets[0].data = data.values;
    bandwidthUtilizationChart.update();
}

// Update function for Network Topology Visualization Chart
function updateNetworkTopologyChart(data) {
    // Assuming data.networkTopology is a network topology data object
    // Implement logic to update the chart with network topology data

    // Placeholder logic:
    const { nodes, edges } = data.networkTopology;

    // Clear existing nodes and edges
    networkTopologyChart.clear();

    // Add new nodes and edges
    nodes.forEach(node => {
        networkTopologyChart.addNode(node.id, node.label);
    });

    edges.forEach(edge => {
        networkTopologyChart.addEdge(edge.id, edge.source, edge.target);
    });

    // Update the chart layout
    networkTopologyChart.layout();
}

// Update function for Correlation Analysis Chart
function updateCorrelationAnalysisChart(data) {
    // Assuming data.correlationAnalysis is a correlation analysis data object
    // Implement logic to update the chart with correlation analysis data

    // Placeholder logic:
    const { variables, correlations } = data.correlationAnalysis;

    // Clear existing data
    correlationAnalysisChart.clear();

    // Add new variables and correlations
    variables.forEach(variable => {
        correlationAnalysisChart.addVariable(variable);
    });

    correlations.forEach(correlation => {
        correlationAnalysisChart.addCorrelation(correlation.variable1, correlation.variable2, correlation.value);
    });

    // Update the chart layout
    correlationAnalysisChart.layout();
}


        // Initialize charts
        var protocolChart = initLineChart(protocolContext, { labels: [], datasets: [{ label: 'Protocol Distribution', backgroundColor: 'rgba(255, 99, 132, 0.2)', borderColor: 'rgba(255, 99, 132, 1)', data: [] }] });
        var packetSizeChart = initBarChart(packetSizeContext, { labels: ['0-200', '201-400', '401-600', '601-800', '801-1000'], datasets: [{ label: 'Packet Size Distribution', backgroundColor: 'rgba(54, 162, 235, 0.2)', borderColor: 'rgba(54, 162, 235, 1)', data: [] }] });

        // Fetch data every second
        setInterval(fetchData, 1000);

    </script>
</body>
</html>
